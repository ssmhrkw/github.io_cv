# 💻 矩形板の駆動点インピーダンス（リアルタイム）: 詳細分析

## 📄 アプリケーションの概要

このツールは、四辺単純支持（SSSS: Simply Supported on all four sides）の**矩形薄板（Kirchhoff Thin Plate）** モデルに基づき、特定の駆動点における**機械インピーダンス $|Z|$** および **モビリティ $|Y|$** を、**モード和**によって周波数領域で計算し、可視化します。

### 🎓 計算モデル

| 項目 | 詳細 |
| :--- | :--- |
| **構造モデル** | Kirchhoff薄板理論 |
| **境界条件** | **四辺単純支持 (SSSS)** |
| **計算手法** | **モード和（Modal Summation）**：無限個の固有振動モードのうち、指定された**次数 $m_{\text{max}}, n_{\text{max}}$** までのモードを重ね合わせる。 |
| **出力** | 駆動点インピーダンス $Z=1/Y$、駆動点モビリティ $Y$ |
| **減衰** | 構造減衰（**損失係数 $\eta$**）を考慮。 |

### 📊 主な出力項目

* **駆動点インピーダンス $|Z|$**: グラフと表で表示。
* **駆動点モビリティ $|Y|$**: グラフで表示（オプション）。
* **無限長板インピーダンス $Z_\infty$**: 周波数非依存の基準値。
* **オクターブ平均値**: $1/1$ オクターブバンドの中心周波数（$16 \text{ Hz}$〜$2000 \text{ Hz}$）におけるバンド平均値を計算。
* **固有振動数**: $f_{11}$ から $f_{32}$ までの共振周波数リスト。

---

# 📝 使い方（ステップバイステップ）

アプリケーションは、「**設定（左側）**」と「**結果（右側）**」の 2 つの領域で構成されています。

## 1. 入力パラメーターの設定

### A. 材料と寸法の設定

| 項目 | ID | 説明 |
| :--- | :--- | :--- |
| **材料プリセット** | `material` | コンクリート、合板など、定義済みの材料物性値を自動入力（手動入力も可能）。 |
| **ヤング率 $E$ $[\text{Pa}]$** | `E` | 材料の剛性を示す値。 |
| **密度 $\rho$ $[\text{kg/m}^3]$** | `rho` | 材料の密度。 |
| **ポアソン比 $\nu$ $[-]$** | `nu` | 横ひずみと縦ひずみの比率。$0.0$ から $0.49$ の間。 |
| **損失係数 $\eta$ $[\%]$** | `eta` | 振動エネルギーの減衰を表す値（$\eta = 0.5\% \rightarrow 0.005$）。 |
| **板厚 $h$ $[\text{mm}]$** | `thick` | 矩形板（スラブ）の厚さ。 |
| **$L_x, L_y$ $[\text{m}]$** | `Lx, Ly` | 矩形板の短辺・長辺スパン。 |

### B. 測定点と計算範囲の設定

| 項目 | ID | 説明 |
| :--- | :--- | :--- |
| **測定点モード** | `pt_single` / `pt_grid` | **単点** (Single) または**格子平均** (Grid) を選択。 |
| **単点座標** | `x0mm, y0mm` | 駆動点 $x_0, y_0$ の座標 $[\text{mm}]$。原点は $(0, 0)$。 |
| **格子分割数** | `Nx, Ny` | 格子平均時の分割数。平均は格子点 $(m+0.5)/N_x \cdot L_x$ で計算。 |
| **平均方法** | `avg_linear` / `avg_db` | 複数点計算時、絶対値の**線形平均（算術平均）** または **$\text{dB}$ 値の平均**を選択。 |
| **周波数範囲** | `fmin, fmax` | 計算・表示を行う周波数の最小値・最大値 $[\text{Hz}]$。 |
| **モード次数** | `mx, ny` | モード和計算に使用する**最大次数 $m_{\text{max}}, n_{\text{max}}$**。この値を大きくすると計算精度が向上するが、処理時間が長くなります。 |

### C. 表示オプション

| 項目 | ID | 説明 |
| :--- | :--- | :--- |
| **表示対象** | `showZ` / `showY` | $|Z|$（インピーダンス）、$|Y|$（モビリティ）の表示切替。 |
| **軸の形式** | `logx` / `db` | **$x$ 軸（周波数）** を $\text{log}$ スケール、**$y$ 軸（レベル）** を $\text{dB}$（$20 \log_{10}$）表示にするかを設定。 |
| **特殊要素** | `toggleOct`, `toggleInf`, `toggleModes` | **オクターブ平均値（★）**、**無限長板（●）**、**固有振動数（▲）** の表示・非表示を切り替えるボタン。 |

---

## 2. 結果の確認

入力値の変更は即座に計算に反映され、右側のパネルが更新されます。

### A. 主要特性値 (KPI)

入力値から算出される板の基本的な特性値が表示されます。

* **薄板曲げ剛性 $D$**: $D = \frac{E h^3}{12(1-\nu^2)}$
* **単位面積質量 $m'$**: $m' = \rho h$
* **一次固有振動数 $f_{11}$**: $(m=1, n=1)$ モードの固有振動数。

### B. サマリーテーブル

入力されたすべてのパラメーターと計算された主要特性値が一覧表示されます。

### C. グラフ表示

| 項目 | 表示内容 | 凡例シンボル |
| :--- | :--- | :--- |
| **駆動点インピーダンス $|Z|$ または $|Y|$** | モード和による計算結果の周波数特性曲線。 | (線) |
| **オクターブ平均** | グラフの曲線から算出した、標準 $1/1$ オクターブバンドの中心周波数における平均レベル。 | **★** |
| **無限長板インピーダンス** | $Z_\infty$ の値（$\text{dB}$ または線形）をマーカーで表示。 | **●** |
| **固有振動数** | $f_{mn}$（特に $f_{11}$ から $f_{32}$ まで）の位置をマーク。 | **▲** |

### D. 数値表

* **オクターブバンド値**: $\text{dB}$ または線形値で、オクターブ平均値（★）と無限長板値（●）を比較表示。
* **共振周波数リスト**: $f_{11}, f_{12}, f_{21}, f_{22}, f_{31}, f_{32}$ の具体的な周波数 $[\text{Hz}]$ が表示されます。

### E. 計算式

「**計算式（MathJax）を表示**」を展開すると、モード形状、固有角振動数、モード和によるモビリティの定義式など、計算の根拠となる数式を確認できます。

---

## 3. その他の操作

* **PNG保存**: 「**PNG保存**」ボタンで、現在のグラフを画像ファイルとしてダウンロードします。
* **リセット**: 「**リセット**」ボタンで、全ての入力値を初期状態（コンクリート、標準寸法など）に戻します。
