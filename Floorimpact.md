# 床衝撃音遮断性能予測ツール

このHTMLファイルは、「**床衝撃音レベル予測（重量衝撃源）**」のためのウェブアプリケーションです。日本の建築環境における**実務的騒音対策指針**に基づいた、コンクリートスラブ等の床構造からの重量衝撃音レベル（$L_{\text{i,F,max}}$）を予測するための計算ツールとして機能します。

---

## 🛠️ ステップ 1: スラブと室の基本設定

上部の入力欄に、床スラブと室の基本的な物理特性を入力します。

| 項目 | 入力値の目安と注意点 |
| :--- | :--- |
| **室の短辺 $a_{\text{room}}$、長辺 $b_{\text{room}}$ $[\text{mm}]$** | 衝撃を受ける室の寸法。スラブスパンの計算にも使用されます。 |
| **厚さ $h$ $[\text{mm}]$** | 床スラブの厚さ。最低 $80 \text{ mm}$。 |
| **密度 $\rho [\text{kg/m}^3]$** | コンクリートの密度。通常 $2300$ を使用。 |
| **ヤング率 $E \times 10^{10} [\text{N/m}^2]$** | スラブのヤング率。通常 $2.1$ を使用。 |
| **下室吸音力 $A [\text{m}^2]$** | 衝撃音を受ける下の室の総吸音力。**室の吸音性能**に大きく影響します。 |
| **衝撃周波数 $f_\theta [\text{Hz}]$** | 重量衝撃源（タイヤ）の特性周波数。通常 $25 \text{ Hz}$ を使用します。 |
| **$\Delta L_z$ 合成法** | 梁による損失係数 $\Delta L_z$ の合成方法を選択します。(a)エネルギー和 または (b)算術和。 |

### 面積とスパンの設定

* **スラブ面積＝室面積**: チェックを入れると、スラブのスパンは室の寸法 $(a_{\text{room}}, b_{\text{room}})$ と同じと見なされます。
* チェックを**外す**と、「スラブ短辺 $L_x$ / 長辺 $L_y$」の入力欄が出現し、$L_x, L_y$ を使って一次固有振動数 $f_{n1}$ が計算されます。

---

## 📌 ステップ 2: 加振点（S1〜S5）の設定

重量衝撃源（タイヤ）を叩く**加振点**の座標 $(x, y)$ と、その点の境界条件（梁）を設定します。

1.  **自動入力**: 「**対角 $5$ 点を自動入力**」ボタンをクリックすると、典型的な解析点である $(1/3, 1/3), (2/3, 1/3), \dots$ を近似した $5$ 点の座標が自動で入力されます。
2.  **座標の調整**: 必要に応じて、各加振点 $S1$ から $S5$ の $x$ 座標と $y$ 座標 $[\text{mm}]$ を調整します。
3.  **有効性の設定**: $S4/S5$ が不要な場合は「有効」チェックボックスを**オフ**にします。
4.  **端部条件の設定**: 各加振点について、その位置における $x$ 方向・$y$ 方向の**端部条件**（梁なし、小ばり、大ばり）を選択します。これは**梁による損失係数 $\Delta L$** の計算に使用されます。

---

## ▶️ ステップ 3: 計算の実行と結果の確認

設定が完了したら、計算を実行し、結果を確認します。

1.  **計算実行**: 画面下部の「**計算（S1-1〜S1-8）**」ボタンをクリックします。
2.  **概要の確認**: 上部に以下の主要計算結果が表示されます。
    * **$Z_r$（基準インピーダンス）**: スラブの剛性を示す値。
    * **$f_{n1}$（一次固有振動数）**: スラブの固有振動数。
    * **判定帯域**: $f_{n1}$ に基づいて決定される、**インピーダンスレベル周波数特性**の基準帯域（$31.5 \text{ Hz}, 63 \text{ Hz}, 125 \text{ Hz}$ のいずれか）。
3.  **詳細テーブルの確認**:
    * テーブルには、$63 \text{ Hz}, 125 \text{ Hz}, 250 \text{ Hz}, 500 \text{ Hz}$ の $4$ 帯域における、ステップごとの計算詳細がすべて表示されます。
    * 最下行の「**平均 $L$**」が、すべての加振点を考慮した予測床衝撃音レベルです。
4.  **等級の判定**:
    * **平均スペクトルによる $L_{\text{L}}$ 等級**: 平均 $L$ スペクトルがどの $L_{\text{L}}$ 遮音等級曲線（$L_{\text{L}}-40, L_{\text{L}}-45, \dots$）に相当するかを判定します。
    * **しゃ音等級数（$L_{\text{num}}, L_{\text{suu}}$）**: 平均 $L$ スペクトルから、**リファレンススペクトル**に対する最小シフト量を求め、しゃ音等級数 $L_{\text{num}}$ を表示します。
---

## 📐 アプリケーションの概要

このツールは、床スラブの物理特性（寸法、厚さ、密度、ヤング率）と室内の吸音力、および衝撃源の特性（衝撃周波数）を入力として、**$63 \text{ Hz}$、 $125 \text{ Hz}$、$250 \text{ Hz}$、$500 \text{ Hz}$** の $4$ つのオクターブバンドにおける予測床衝撃音レベル $L$ を計算します。

### 主要な計算ステップ（S1-1〜S1-8）

計算は、主に以下の指針に基づいています。

1.  **基準インピーダンス $Z_r$ の計算**（S1-2）
2.  **一次固有振動数 $f_{n1}$ の計算**（S1-4(a)）
3.  **判定帯域の決定**（$f_{n1}$ に基づく）
4.  **加振点インピーダンスレベル $L_{z,\theta}$ の計算**
5.  **床インピーダンスレベル周波数特性 $L_{z,f}$ の計算**
6.  **床衝撃音レベル $L$ の計算**（$L = L_{\text{i,F,max}} \approx 152 + F_{\text{RMS}} - L_{z,f} + 10\log S_{\text{eff}} + 10\log k - 10\log A + \Delta L_{\text{peak}}$）
7.  **平均 $L$ に基づく $L_{\text{L}}$ 等級の判定**

### 計算に使用される主要な定数

| 定数 | 値 | 単位 | 備考 |
| :--- | :--- | :--- | :--- |
| $\Delta L_{\text{peak}}$ | $8$ | $\text{dB}$ | 時定数の補正項 |
| $152$ | $152$ | $\text{dB}$ | 予測式（$L$）の基底定数 |
| $F_{\text{RMS}}(f)$ | $63\text{ Hz} : 32$ | $\text{dB}$ | 衝撃源（タイヤ等）の**衝撃力二乗平均值レベル** |
| | $125\text{ Hz} : 20$ | $\text{dB}$ | |
| | $250\text{ Hz} : 13$ | $\text{dB}$ | |
| | $500\text{ Hz} : 4$ | $\text{dB}$ | |

---

## 🧱 入力パラメーター

| 項目 | ID | 単位/備考 | 説明 |
| :--- | :--- | :--- | :--- |
| **室の寸法** | `a_mm`, `b_mm` | $\text{mm}$ | 室の短辺および長辺。 |
| **スラブ厚** | `h_mm` | $\text{mm}$ | コンクリートスラブ等の厚さ。 |
| **密度** | `rho` | $\text{kg/m}^3$ | スラブの密度。標準は $2300 \text{ kg/m}^3$。 |
| **ヤング率** | `E10` | $\times 10^{10} \text{ N/m}^2$ | スラブのヤング率（弾性率）。$E$ を $10^{10}$ で割った値で入力。標準は $2.1$。 |
| **下室吸音力** | `A_m2` | $\text{m}^2$ | 衝撃音を受ける下の室の総吸音力。 |
| **衝撃周波数** | `f_theta` | $\text{Hz}$ | 衝撃源の特性周波数（タイヤの場合は $25 \text{ Hz}$ が推奨値）。 |
| **$\Delta L_{z}$ 合成法** | `combine` | | 損失係数 $\Delta L_{z}$ の合成方法（(a) エネルギー和 or (b) 算術和）。 |
| **スラブ/室面積** | `sameArea` | $\text{checkbox}$ | スラブスパン $L_x, L_y$ が室の寸法 $a_{\text{room}}, b_{\text{room}}$ と同じかどうかの設定。|

---

## 📌 加振点（S1〜S5）

床衝撃音の予測には、スラブ上の複数の**加振点**での計算が必要です。

-   **入力**：加振点の $x, y$ 座標（$\text{mm}$）と、その点における $x$ 方向・$y$ 方向の**端部条件**（梁なし、小ばり、大ばり）。
-   **機能**：
    -   `fill5` ボタンで、**対角 $5$ 点**（$(1/3, 1/3), (2/3, 1/3), (1/3, 2/3), (2/3, 2/3), (1/2, 1/2)$ の近似点）を自動入力可能。
    -   $S1 \sim S3$ は必須、$S4 / S5$ は任意（チェックボックスで有効/無効を切り替え）。
-   **端部条件の影響**：
    -   端部から加振点までの距離 $\lambda$ と、衝撃周波数 $f_\theta$ に対応する曲げ波の波長 $\lambda_\theta$ の比 $r = \lambda / \lambda_\theta$ を使用し、**梁による損失係数 $\Delta L$** を内挿（`interpDL` 関数）で決定します。
    -   「梁なし」：$\Delta L = 0$
    -   「小ばり」「大ばり」：それぞれ定義された損失テーブル（`DL_CURVE`）に基づいて $\Delta L$ を決定。
    -   $x$ 方向と $y$ 方向の損失 $\Delta L_1, \Delta L_2$ は、選択された合成法（`combine`）で $\Delta L_z$ に結合されます。

---

## 📊 出力結果

### 1. 概略計算結果

| 項目 | ID | 算出式（抜粋） | 備考 |
| :--- | :--- | :--- | :--- |
| **基準インピーダンス** | `zrBox` | $Z_r = \frac{4}{\sqrt{3}}\sqrt{\rho}\sqrt{E}h^2$ | |
| **一次固有振動数** | `fn1Box` | $f_{n1} \approx 0.8 \cdot \frac{\pi}{4\sqrt{3}}\left(\frac{2.25}{a_{\text{span}}^2}+\frac{1.4}{b_{\text{span}}^2}\right)c_l h$ | |
| **判定帯域** | `bandBox` | $f_{n1}$ に基づき $31.5 \text{ Hz}, 63 \text{ Hz}, 125 \text{ Hz}$ 帯のいずれかを決定。| 周波数特性の補正（`relLZ`）に使用。|

### 2. 周波数帯域ごとの計算詳細

| 項目（行） | 略称/単位 | 算出式（抜粋） | 備考 |
| :--- | :--- | :--- | :--- |
| **(2) $20\log Z_\theta$** | $\text{dB}$ | $L_{zr} + \Delta L_z$ | **加振点インピーダンスレベル** |
| **(3) 周波数特性** | $\text{dB}$ | `relLZ(band, f)` | 判定帯域からの相対補正値。|
| **(4) $20\log Z_b$** | $\text{dB}$ | $\text{(2)} + \text{(3)}$ | **床インピーダンスレベル** $L_{z,f}$。 |
| **(6) 有効放射面積 $S_{\text{eff}}$** | $\text{m}^2$ | $\max(a-\lambda_b/4, 0) \cdot \max(b-\lambda_b/2, 0)$ | 室寸法 $a, b$ と曲げ波波長 $\lambda_b$ に基づく。|
| **(8) $10\log k$** | $\text{dB}$ | `k_dB(h_mm, f)` | 厚さ $h_{\text{mm}}$ に応じた補正（テーブル参照）。|
| **(12) 床衝撃音レベル $L$** | $\text{dB}$ | $\text{(S1-8)}$ 式の最終結果 | $F_{\text{RMS}}(f) - L_{z,f} + 10\log S_{\text{eff}} + 10\log k - 10\log A + \Delta L_{\text{peak}} + 152$ |
| **平均 $L$** | $\text{dB}$ | 全ての有効加振点の算術平均 | 最終等級判定に使用。|

### 3. 等級判定

-   **$L_{\text{L}}$ 等級** (`grade`):
    -   平均 $L$ スペクトルを、設定された**$L_{\text{L}}$ 等級曲線**（`L_CURVE`）と比較し、その曲線以下に収まる最小の等級（$L_{\text{L}}-40$ など）を判定。
-   **しゃ音等級数 $L_{\text{num}}$** (`lnum`):
    -   平均 $L$ スペクトルと**リファレンススペクトル** $\text{REF} = [53, 43, 36, 30]$ の差が全帯域で $2 \text{ dB}$ 以下となる最小シフト量 $i$ を求め、**$30 + i$** を**しゃ音等級数 $L_{\text{num}}$** として表示。
