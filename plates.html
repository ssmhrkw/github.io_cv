<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Plate Acoustics – Impedance/STL/Radiation</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <style>
    body{font-family:'Segoe UI', Meiryo, sans-serif; margin:0; padding:12px; background:#f4f4f4; font-size:14px; display:flex; flex-direction:row; gap:16px;}
    fieldset{border:1px solid #ccc; border-radius:6px; background:#fff; padding:12px; margin:0;}
    legend{font-weight:600; padding:0 6px;}
    .left{width:420px; min-width:420px; display:flex; flex-direction:column; gap:12px;}
    .right{flex:1; display:flex; flex-direction:column; gap:12px;}
    .grid{display:grid; grid-template-columns:140px 1fr 40px; gap:8px; align-items:center;}
    .grid-2{display:grid; grid-template-columns:140px 1fr; gap:8px; align-items:center;}
    label{font-size:14px;}
    input,select{width:100%; box-sizing:border-box; padding:8px; border:1px solid #ccc; border-radius:4px;}
    input[disabled]{opacity:.6}
    .tabs{display:flex; gap:6px; border-bottom:1px solid #ccc;}
    .tab-btn{background:#f1f1f1; border:1px solid #ccc; border-bottom:none; border-radius:6px 6px 0 0; padding:8px 12px; cursor:pointer;}
    .tab-btn.active{background:#fff;}
    .tab{display:none; border:1px solid #ccc; border-top:none; background:#fff; padding:12px;}
    .tab.active{display:block;}
    table{width:100%; border-collapse:collapse; margin-top:8px; background:#fff;}
    th,td{border:1px solid #ddd; padding:6px 8px; text-align:right;}
    th{text-align:center; background:#f7f7f7;}
    .chart-wrap{position:relative; width:100%; height:420px;}
    .badge{background:#eee; border-radius:10px; padding:2px 8px; margin-left:6px;}
    .inline-table th{background:#fafafa;}
    .controls-row{display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-bottom:8px;}
    .hint{color:#777; font-size:12px;}
    .unit{color:#555; font-size:12px;}
    .avg-grid{display:grid; grid-template-columns:140px 1fr; gap:8px 12px; align-items:center;}
    .span2{grid-column:1 / span 2;}
    .pos-block .row{display:grid; grid-template-columns:140px 1fr; gap:8px 12px; align-items:center; margin-bottom:6px;}
  </style>
</head>
<body>
  <div class="left">
    <fieldset>
      <legend>Common Input Conditions</legend>
      <div class="grid">
        <label for="material-select">Material:</label>
        <select id="material-select"></select><span></span>
        <label for="thick-input">Thickness (h):</label>
        <input id="thick-input" type="number" value="180"><span>mm</span>
        <label for="lx-input">Length (Lx):</label>
        <input id="lx-input" type="number" value="3000"><span>mm</span>
        <label for="ly-input">Width (Ly):</label>
        <input id="ly-input" type="number" value="4000"><span>mm</span>
      </div>
    </fieldset>

    <fieldset>
      <legend>Material Properties (Editable) & Basic Properties (Auto)</legend>
      <div class="grid">
        <label for="e-input">Young's Modulus (E):</label>
        <input id="e-input" type="text"><span>Pa</span>
        <label for="rho-input">Density (ρ):</label>
        <input id="rho-input" type="text"><span>kg/m³</span>
        <label for="nu-input">Poisson's (ν):</label>
        <input id="nu-input" type="text"><span></span>
      </div>
      <!-- auto basic properties -->
      <table class="inline-table" id="basic-inline"></table>
    </fieldset>

    <fieldset>
      <legend>Positions / Averaging</legend>
      <div class="avg-grid">
        <div id="pos-block" class="span2 pos-block">
          <div class="row">
            <label for="pos-x">Position X:</label>
            <input id="pos-x" type="number" value="1500"><span class="unit">mm</span>
          </div>
          <div class="row">
            <label for="pos-y">Position Y:</label>
            <input id="pos-y" type="number" value="2000"><span class="unit">mm</span>
          </div>
        </div>

        <label class="span2">
          <input id="use-mesh" type="checkbox" checked> Use grid average
          <span class="hint">(Nx/Ny cells, arithmetic mean on linear complex Z)</span>
        </label>

        <label for="nx-input">Nx (cells):</label>
        <div>
          <input id="nx-input" type="number" min="1" max="200" step="1" value="5">
        </div>

        <label for="ny-input">Ny (cells):</label>
        <div>
          <input id="ny-input" type="number" min="1" max="200" step="1" value="6">
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>Options</legend>
      <div class="grid-2">
        <label>Show datasets:</label>
        <div class="controls-row">
          <label><input type="checkbox" id="show-mag"> |Z| [dB]</label>
          <label><input type="checkbox" id="show-re"> Re(Z) [dB]</label>
          <label><input type="checkbox" id="show-ph"> Phase [deg]</label>
        </div>
        <label for="baffle-cond">Baffle Condition:</label>
        <select id="baffle-cond">
          <option value="1">In-plane</option>
          <option value="2">Rigid</option>
        </select>
      </div>
    </fieldset>
  </div>

  <div class="right">
    <div class="tabs">
      <button class="tab-btn active" data-tab="imp">Impedance</button>
      <button class="tab-btn" data-tab="stl">Sound Transmission Loss</button>
      <button class="tab-btn" data-tab="rad">Radiation Efficiency</button>
    </div>

    <div id="tab-imp" class="tab active">
      <div class="chart-wrap"><canvas id="impedance-chart"></canvas></div>
      <table id="impedance-table"></table>
      <hr>
      <table id="inf-impedance-table"></table>
      <div id="impedance-formula"></div>
    </div>

    <div id="tab-stl" class="tab">
      <div class="chart-wrap"><canvas id="stl-chart"></canvas></div>
      <table id="stl-table"></table>
      <div id="stl-formula"></div>
    </div>

    <div id="tab-rad" class="tab">
      <div class="chart-wrap"><canvas id="rad-chart"></canvas></div>
      <table id="rad-table"></table>
      <div id="rad-formula"></div>
    </div>
  </div>

  <script src="./plate_impedance.js"></script>
</body>
</html>
